function cov_yhcwzb5dc(){var path="C:\\Users\\lucas.macgregor\\Documents\\ProyectoInicial\\backend\\jwt-functions\\jwt-functions.js";var hash="713b5ea8c601f4c6e8c3335c07dbca6dd0984387";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\lucas.macgregor\\Documents\\ProyectoInicial\\backend\\jwt-functions\\jwt-functions.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:35}},"1":{start:{line:2,column:12},end:{line:2,column:35}},"2":{start:{line:3,column:19},end:{line:3,column:37}},"3":{start:{line:7,column:4},end:{line:22,column:21}},"4":{start:{line:8,column:8},end:{line:14,column:9}},"5":{start:{line:9,column:12},end:{line:9,column:50}},"6":{start:{line:12,column:12},end:{line:12,column:59}},"7":{start:{line:13,column:12},end:{line:13,column:24}},"8":{start:{line:15,column:8},end:{line:19,column:25}},"9":{start:{line:16,column:12},end:{line:16,column:68}},"10":{start:{line:19,column:12},end:{line:19,column:25}},"11":{start:{line:22,column:8},end:{line:22,column:21}},"12":{start:{line:27,column:4},end:{line:42,column:21}},"13":{start:{line:28,column:8},end:{line:34,column:9}},"14":{start:{line:29,column:12},end:{line:29,column:50}},"15":{start:{line:32,column:12},end:{line:32,column:59}},"16":{start:{line:33,column:12},end:{line:33,column:24}},"17":{start:{line:35,column:8},end:{line:39,column:25}},"18":{start:{line:36,column:12},end:{line:36,column:24}},"19":{start:{line:39,column:12},end:{line:39,column:25}},"20":{start:{line:42,column:8},end:{line:42,column:21}},"21":{start:{line:45,column:0},end:{line:45,column:47}}},fnMap:{"0":{name:"extractTokenInfo",decl:{start:{line:5,column:9},end:{line:5,column:25}},loc:{start:{line:5,column:33},end:{line:23,column:1}},line:5},"1":{name:"validateJWT",decl:{start:{line:25,column:9},end:{line:25,column:20}},loc:{start:{line:25,column:28},end:{line:43,column:1}},line:25}},branchMap:{"0":{loc:{start:{line:7,column:4},end:{line:22,column:21}},type:"if",locations:[{start:{line:7,column:4},end:{line:22,column:21}},{start:{line:7,column:4},end:{line:22,column:21}}],line:7},"1":{loc:{start:{line:15,column:8},end:{line:19,column:25}},type:"if",locations:[{start:{line:15,column:8},end:{line:19,column:25}},{start:{line:15,column:8},end:{line:19,column:25}}],line:15},"2":{loc:{start:{line:27,column:4},end:{line:42,column:21}},type:"if",locations:[{start:{line:27,column:4},end:{line:42,column:21}},{start:{line:27,column:4},end:{line:42,column:21}}],line:27},"3":{loc:{start:{line:35,column:8},end:{line:39,column:25}},type:"if",locations:[{start:{line:35,column:8},end:{line:39,column:25}},{start:{line:35,column:8},end:{line:39,column:25}}],line:35}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"713b5ea8c601f4c6e8c3335c07dbca6dd0984387"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_yhcwzb5dc=function(){return actualCoverage;};}return actualCoverage;}cov_yhcwzb5dc();const logger=(cov_yhcwzb5dc().s[0]++,require("../logger"));const jwt=(cov_yhcwzb5dc().s[1]++,require('jsonwebtoken'));const SECRET_KEY=(cov_yhcwzb5dc().s[2]++,'clavesecreta1234');function extractTokenInfo(token){cov_yhcwzb5dc().f[0]++;let decode;cov_yhcwzb5dc().s[3]++;if(token!==undefined){cov_yhcwzb5dc().b[0][0]++;cov_yhcwzb5dc().s[4]++;try{cov_yhcwzb5dc().s[5]++;decode=jwt.verify(token,SECRET_KEY);}catch(error){cov_yhcwzb5dc().s[6]++;logger.error(`JWT Validation error: ${error}`);cov_yhcwzb5dc().s[7]++;decode=null;}cov_yhcwzb5dc().s[8]++;if(decode!==null){cov_yhcwzb5dc().b[1][0]++;cov_yhcwzb5dc().s[9]++;return{username:decode.username,email:decode.email};}else{cov_yhcwzb5dc().b[1][1]++;cov_yhcwzb5dc().s[10]++;return false;}}else{cov_yhcwzb5dc().b[0][1]++;cov_yhcwzb5dc().s[11]++;return false;}}function validateJWT(token){cov_yhcwzb5dc().f[1]++;let decode;cov_yhcwzb5dc().s[12]++;if(token!==undefined){cov_yhcwzb5dc().b[2][0]++;cov_yhcwzb5dc().s[13]++;try{cov_yhcwzb5dc().s[14]++;decode=jwt.verify(token,SECRET_KEY);}catch(error){cov_yhcwzb5dc().s[15]++;logger.error(`JWT Validation error: ${error}`);cov_yhcwzb5dc().s[16]++;decode=null;}cov_yhcwzb5dc().s[17]++;if(decode!==null){cov_yhcwzb5dc().b[3][0]++;cov_yhcwzb5dc().s[18]++;return true;}else{cov_yhcwzb5dc().b[3][1]++;cov_yhcwzb5dc().s[19]++;return false;}}else{cov_yhcwzb5dc().b[2][1]++;cov_yhcwzb5dc().s[20]++;return false;}}cov_yhcwzb5dc().s[21]++;module.exports={extractTokenInfo,validateJWT};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXIiLCJyZXF1aXJlIiwiand0IiwiU0VDUkVUX0tFWSIsImV4dHJhY3RUb2tlbkluZm8iLCJ0b2tlbiIsImRlY29kZSIsInVuZGVmaW5lZCIsInZlcmlmeSIsImVycm9yIiwidXNlcm5hbWUiLCJlbWFpbCIsInZhbGlkYXRlSldUIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImp3dC1mdW5jdGlvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbG9nZ2VyID0gcmVxdWlyZShcIi4uL2xvZ2dlclwiKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcbmNvbnN0IFNFQ1JFVF9LRVkgPSAnY2xhdmVzZWNyZXRhMTIzNCc7XHJcblxyXG5mdW5jdGlvbiBleHRyYWN0VG9rZW5JbmZvKHRva2VuKSB7XHJcbiAgICBsZXQgZGVjb2RlO1xyXG4gICAgaWYgKHRva2VuIT09dW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZGVjb2RlID0gand0LnZlcmlmeSh0b2tlbixTRUNSRVRfS0VZKTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIGNhdGNoICggZXJyb3IgKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihgSldUIFZhbGlkYXRpb24gZXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgICAgICAgICAgIGRlY29kZT1udWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGVjb2RlIT09IG51bGwpe1xyXG4gICAgICAgICAgICByZXR1cm4ge3VzZXJuYW1lOiBkZWNvZGUudXNlcm5hbWUsIGVtYWlsOiBkZWNvZGUuZW1haWx9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICBcclxuICAgIH0gZWxzZSBcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlSldUKHRva2VuKSB7XHJcbiAgICBsZXQgZGVjb2RlO1xyXG4gICAgaWYgKHRva2VuIT09dW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZGVjb2RlID0gand0LnZlcmlmeSh0b2tlbixTRUNSRVRfS0VZKTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIGNhdGNoICggZXJyb3IgKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihgSldUIFZhbGlkYXRpb24gZXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgICAgICAgICAgIGRlY29kZT1udWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGVjb2RlIT09IG51bGwpe1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgXHJcbiAgICB9IGVsc2UgXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cz17ZXh0cmFjdFRva2VuSW5mbywgdmFsaWRhdGVKV1R9OyJdLCJtYXBwaW5ncyI6InFsR0FlWTtBQUFBLHlGQWZaLEtBQU1BLE9BQU0seUJBQUdDLE9BQU8sQ0FBQyxXQUFXLENBQUMsRUFDbkMsS0FBTUMsSUFBRyx5QkFBR0QsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUNuQyxLQUFNRSxXQUFVLHlCQUFHLGtCQUFrQixFQUVyQyxRQUFTQyxpQkFBZ0IsQ0FBQ0MsS0FBSyxDQUFFLHdCQUM3QixHQUFJQyxPQUFNLENBQUMsdUJBQ1gsR0FBSUQsS0FBSyxHQUFHRSxTQUFTLENBQUUsa0RBQ25CLEdBQUksd0JBQ0FELE1BQU0sQ0FBR0osR0FBRyxDQUFDTSxNQUFNLENBQUNILEtBQUssQ0FBQ0YsVUFBVSxDQUFDLENBQ3pDLENBQ0EsTUFBUU0sS0FBSyxDQUFHLHdCQUNaVCxNQUFNLENBQUNTLEtBQUssQ0FBRSx5QkFBd0JBLEtBQU0sRUFBQyxDQUFDLENBQUMsdUJBQy9DSCxNQUFNLENBQUMsSUFBSSxDQUNmLENBQUMsdUJBQ0QsR0FBSUEsTUFBTSxHQUFJLElBQUksQ0FBQyxrREFDZixNQUFPLENBQUNJLFFBQVEsQ0FBRUosTUFBTSxDQUFDSSxRQUFRLENBQUVDLEtBQUssQ0FBRUwsTUFBTSxDQUFDSyxLQUFLLENBQUMsQ0FDM0QsQ0FBQyxJQUVHLHlEQUFPLE1BQUssRUFFcEIsQ0FBQyxJQUNHLHlEQUFPLE1BQUssRUFDcEIsQ0FFQSxRQUFTQyxZQUFXLENBQUNQLEtBQUssQ0FBRSx3QkFDeEIsR0FBSUMsT0FBTSxDQUFDLHdCQUNYLEdBQUlELEtBQUssR0FBR0UsU0FBUyxDQUFFLG1EQUNuQixHQUFJLHlCQUNBRCxNQUFNLENBQUdKLEdBQUcsQ0FBQ00sTUFBTSxDQUFDSCxLQUFLLENBQUNGLFVBQVUsQ0FBQyxDQUN6QyxDQUNBLE1BQVFNLEtBQUssQ0FBRyx5QkFDWlQsTUFBTSxDQUFDUyxLQUFLLENBQUUseUJBQXdCQSxLQUFNLEVBQUMsQ0FBQyxDQUFDLHdCQUMvQ0gsTUFBTSxDQUFDLElBQUksQ0FDZixDQUFDLHdCQUNELEdBQUlBLE1BQU0sR0FBSSxJQUFJLENBQUMsbURBQ2YsTUFBTyxLQUFJLENBQ2YsQ0FBQyxJQUVHLHlEQUFPLE1BQUssRUFFcEIsQ0FBQyxJQUNHLHlEQUFPLE1BQUssRUFDcEIsQ0FBQyx3QkFFRE8sTUFBTSxDQUFDQyxPQUFPLENBQUMsQ0FBQ1YsZ0JBQWdCLENBQUVRLFdBQVcsQ0FBQyJ9